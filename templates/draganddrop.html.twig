<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draggable SVG Ellipses</title>
    <style>
    svg {
      position: absolute;
    }
  </style>
</head>
<body>
<svg width="500" height="500">
    <ellipse cx="100" cy="100" rx="50" ry="30" fill="red"></ellipse>
    <ellipse cx="200" cy="200" rx="40" ry="25" fill="blue"></ellipse>
    <ellipse cx="300" cy="300" rx="60" ry="35" fill="green"></ellipse>
</svg>

<script>
    const svg = document.querySelector('svg');
    let activeEllipse = null;
    let offset = { x: 0, y: 0 };

    function handleMouseDown(e) {
      activeEllipse = e.target;
      const bbox = activeEllipse.getBBox();
      offset = {
        x: e.clientX - bbox.x,
        y: e.clientY - bbox.y
      };
    }

    function handleMouseMove(e) {
      if (activeEllipse) {
        const bbox = activeEllipse.getBBox();
        activeEllipse.setAttribute('cx', e.clientX - offset.x);
        activeEllipse.setAttribute('cy', e.clientY - offset.y);
      }
    }

    function handleMouseUp() {
      if (activeEllipse) {
        checkForOverlap(activeEllipse)
        activeEllipse = null;
      }
    }

    function checkForOverlap(activeEllipse) {
        // Check for overlap with other ellipses
        ellipses.forEach(ellipse => {
          if (ellipse !== activeEllipse) {
            const rect1 = activeEllipse.getBoundingClientRect();
            const rect2 = ellipse.getBoundingClientRect();
            if (!(rect1.right < rect2.left ||
                  rect1.left > rect2.right ||
                  rect1.bottom < rect2.top ||
                  rect1.top > rect2.bottom)) {
              // If there is an overlap, replace the active ellipse
              ellipse.setAttribute('cx', Math.random() * 100);
              ellipse.setAttribute('cy', Math.random() * 100);
              checkForOverlap(activeEllipse);
              checkForOverlap(ellipse);
            }
          }
        });
    }


    const ellipses = document.querySelectorAll('ellipse');
    ellipses.forEach(ellipse => {
      ellipse.addEventListener('mousedown', handleMouseDown);
    });

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  </script>
</body>
</html>
